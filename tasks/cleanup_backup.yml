- block:
    - name: Obtenir la liste des fichiers de sauvegarde
      find:
        paths: "global_backup_db/"
        patterns: "backup_*_EAZYTraining_*_global_db.sql"
      register: backup_files
      
    - name: Afficher le r√©sultat de regex_replace
      debug:
        var: "item.path | regex_replace('^.{29}(.{2}).*', '\\2')"
      loop: "{{ backup_files.files }}"
    - name: Supprimer les anciens fichiers
      command: "rm {{ item.path }}"
      loop: "{{ backup_files.files }}"
      when: "item.path | regex_replace('^.{29}(.{2}).*', '\\1')} != '05'"

  tags:
    - cleanup_backup
